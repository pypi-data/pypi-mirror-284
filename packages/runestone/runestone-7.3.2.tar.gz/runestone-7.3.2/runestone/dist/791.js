/*! For license information please see 791.js.LICENSE.txt */
"use strict";(self.webpackChunkWebComponents=self.webpackChunkWebComponents||[]).push([[791],{73791:(t,e,s)=>{s.r(e),s.d(e,{BTM:()=>S,exprType:()=>x,exprValue:()=>M,opPrec:()=>k,toTeX:()=>T});class i{constructor(t,e,s,i,n){this.refExpr=t,this.eqExpr=e,this.description=s,this.isValid=i,this.isActive=!0,this.idNum=n}}class n{constructor(t,e){var s=t.eqExpr.dependencies(),i=[];for(var n in s)void 0===e[s[n]]&&i.push(s[n]);for(var n in i)e[i[n]]="input"+(+n+1);var r=t.eqExpr.compose(e);this.subTeX=r.toTeX(),this.subStr=r.toString(),this.name=t.description,r.type==x.binop&&r.valueType==M.bool?this.equation=t.refExpr.toTeX()+" \\iff "+t.eqExpr.toTeX():this.equation=t.refExpr.toTeX()+"="+t.eqExpr.toTeX(),this.bindings=e,this.numInputs=i.length,this.ruleID=t.idNum}}function r(t,e,s,n,r,a,u){var h=s.split("==");if(2!=h.length)console.log("Invalid equation in identity list: "+s);else for(var o=0;o<=1&&(1!=o||void 0===a||!a);o++){var p,l=t.parse(h[o],"formula"),c=t.parse(h[1-o],"formula"),v=(l.dependencies().length,[h[o]]),d=[];for(var f in v){var b=t.parse(v[f],"formula"),m=!0;for(var w in d)null!==d[w].match(b,{})&&(m=!1);if(m){var y=e.length+1;p=new i(b,c,n,r,y),e.push(p),d.push(b)}}}}function a(t,e,s){var i,r,a=[];for(i in t){var u=(r=t[i]).refExpr.match(e,{});if(r.isActive&&null!==u){var h=new n(r,u);a.push(h)}}return a}class u{constructor(){this.select=!1,this.parent=null,this.inputs=[],this.valueType=M.undef,this.context=void 0}value(t){}setContext(t){for(var e in this.context=t,this.inputs)this.inputs[e].setContext(t)}setParsingError(t){this.parseError=t}hasParsingError(){var t=!1,e=0;for(this.parseError&&(t=!0);!t&&e<this.inputs.length;)t=this.inputs[e].hasParsingError(),e++;return t}getParsingError(){for(var t=this.parseError;!t&&0<this.inputs.length;)t=this.inputs[0].getParsingError();return t}toString(t){return void 0===t&&(t=!1),""}toTeX(t){return void 0===t&&(t=!1),this.toString()}toMathML(){return"<mi>"+this.toString()+"</mi>"}allStringEquivs(){return[]}flatten(){return this.copy()}isConstant(){return!1}isExpression(){return!1}}class h extends u{constructor(){super(),this.select=!1,this.parent=null,this.inputs=[],this.valueType=M.numeric}value(t){return this.evaluate(t)}setParsingError(t){this.parseError=t}hasParsingError(){var t=!1,e=0;for(this.parseError&&(t=!0);!t&&e<this.inputs.length;)t=this.inputs[e].hasParsingError(),e++;return t}getParsingError(){for(var t=this.parseError;!t&&0<this.inputs.length;)t=this.inputs[0].getParsingError();return t}toString(t){return void 0===t&&(t=!1),""}toTeX(t){return void 0===t&&(t=!1),this.toString()}toMathML(){return"<mi>"+this.toString()+"</mi>"}operateToTeX(){return this.toTeX()}treeToTeX(t){var e={};if(e.parent=void 0===this.parent||null===this.parent?null:this.parent.operateToTeX(),void 0!==t&&t)for(var s in e.current=this.operateToTeX(),e.inputs=[],this.inputs)e.inputs[s]=this.inputs[s].toTeX();else e.current=this.toTeX(),e.inputs=null;return e}allStringEquivs(){return[]}flatten(){return this.copy()}copy(){var t=new h;for(var e in t.valueType=this.valueType,t.context=this.context,this.inputs)t.inputs[e]=t.inputs[e].copy(),t.inputs[e].parent=t;return t}simplifyConstants(t){for(var e in this.inputs)this.inputs[e]=this.inputs[e].simplifyConstants(t),this.inputs[e].parent=this;return this}dependencies(t){var e,s,i=new Array,n={};if(null!=t)for(var r=0;r<t.length;r++)i.push(t[r]),n[t[r]]=!0;for(r in this.inputs)for(s in e=this.inputs[r].dependencies())void 0===n[e[s]]&&(i.push(e[s]),n[e[s]]=!0);return i}getInput(t){if(t<0||t>=this.inputs.length)throw"Attempt to get an undefined input expression.";return this.inputs[t]}isConstant(){var t=!0;for(var e in this.inputs)t&=this.inputs[e].isConstant();return t}evaluate(t,e){return 0}compose(t){return new h}compare(t,e,s,i){var n,r=!0;null==i&&(i=!1),null==s&&(s={});var a=Object.keys(s),u=[],h=1e-8;void 0!==s.rTol&&(h=s.rTol,n=a.indexOf("rTol"),a.splice(n,1));var o=this.dependencies(),p=e.dependencies();for(n=0;n<o.length;n++)a.indexOf(o[n])<0&&u.indexOf(o[n])<0&&u.push(o[n]);for(n=0;n<p.length;n++)a.indexOf(p[n])<0&&u.indexOf(p[n])<0&&u.push(p[n]);var l,c,v,d,f,b,m,w=[],y=[];for(b=10,n=0;n<a.length;n++){v=(c=s[l=a[n]]).min,f=((d=c.max)-v)/b,m=[];for(var g=0;g<b;g++)m[g]=v+g*f;m[b]=d,w.push(l),y.push(m)}for(n=0;n<u.length;n++){for(l=u[n],f=((d=2)-(v=-2))/b,m=[],g=0;g<b;g++)m[g]=v+g*f;m[b]=d,w.push(l),y.push(m)}var k=[];for(n=0;n<w.length;n++)k[n]=0;for(var x,M,T,S=!1;!S&&r;){var q,N,E={};for(n=0;n<w.length;n++)E[l=w[n]]=y[n][k[n]];for(q=this.evaluate(t,E),N=e.evaluate(t,E),isFinite(q)&&isFinite(N)?!(Math.abs(q)<1e-12&&Math.abs(N)<1e-12)&&Math.abs(q-N)/Math.abs(q)>h&&(r=!1):(isFinite(q)&&!isNaN(N)||isFinite(N)&&!isNaN(q))&&(r=!1),g=0,S=!0;g<w.length;){if(k[g]++,!(k[g]>=y[g].length)){S=!1;break}k[g]=0,g++}}if(i&&r&&("+"==this.op||"-"==this.op?x="+":"*"!=this.op&&"/"!=this.op||(x="*"),("+"==x&&"+"!=e.op&&"-"!=e.op||"*"==x&&"*"!=e.op&&"/"!=e.op)&&(r=!1),r))if(M=this.flatten(),T=e.flatten(),M.inputs.length==T.inputs.length){var A=[];for(n=0;n<M.inputs.length;n++)A[n]=!1;for(n=0;n<T.inputs.length&&r;n++){var C=!1;for(g=0;g<M.inputs.length&&!C;g++)!A[g]&&M.inputs[g].compare(T.inputs[n])&&(A[g]=!0,C=!0);C||(r=!1)}}else r=!1;return r}reduce(t){var e,s=this.simplifyConstants(t);for(var i in s.inputs)s.inputs[i]=s.inputs[i].reduce(t);for(e=a(t.reduceRules,s);e.length>0;)s=t.parse(e[0].subStr,this.context),e=a(t.reduceRules,s);return s}derivative(t,e){return new scalar_expr(0)}match(t,e){var s=null;if(this.type==t.type&&this.operateToTeX()==t.operateToTeX()){s=e;for(var i=0;i<this.inputs.length;i++)null!==s&&(s=this.inputs[i].match(t.inputs[i],s))}return s}inputSubst(t,e){var s=this.inputs.indexOf(t);s>=0&&(this.inputs[s]=e,void 0!==e&&(e.parent=this))}}class o{constructor(t){"number"==typeof t||t instanceof Number?this.number=t:t instanceof o&&(this.number=t.number)}value(){return this.number}simplify(){}equal(t){return"number"==typeof t&&(t=new o(t)),this.value()==t.value()}add(t){return"number"==typeof t&&(t=new o(t)),new o(this.number+t.value())}subtract(t){return"number"==typeof t&&(t=new o(t)),new o(this.number-t.value())}multiply(t){return"number"==typeof t&&(t=new o(t)),new o(this.number*t.value())}divide(t){return"number"==typeof t&&(t=new o(t)),0!=t.value?new o(this.number/t.value()):new o(NaN)}addInverse(){return new o(-this.number)}multInverse(){return 0!=this.number?new o(this.number):new o(NaN)}toString(t){void 0===t&&(t=!1);var e=t&&this.number>0?"+":"";return isNaN(this.number)?e="NaN":e+=Number(this.number.toFixed(10)),e}toTeX(t){void 0===t&&(t=!1);var e=t&&this.number>0?"+":"";return isNaN(this.number)?e="\\mathrm{NaN}":e+=Number(this.toString(t)),e}toMathML(t){return"<cn>"+this.toString()+"</cn>"}}function p(t){return void 0===Number.isInteger?t==Math.floor(t):Number.isInteger(t)}class l extends o{constructor(t,e){null==e?(super(t),this.p=t,this.q=1):(super(t/e),0==e?(this.p=Math.sqrt(-1),this.q=1):0==t?(this.p=0,this.q=1):(e<0?(this.p=-t,this.q=-e):(this.p=t,this.q=e),this.simplify()))}value(){return this.p/this.q}simplify(){var t;this.p%1==0&&this.q%1==0&&(t=function(t,e){var s;if((t=Math.abs(t))<(e=Math.abs(e))&&(s=t,t=e,e=s),0==e)return 0;for(;e>0;)s=t%e,t=e,e=s;return t}(this.p,this.q),this.p/=t,this.q/=t)}equal(t){return t instanceof l?this.p.valueOf()==t.p.valueOf()&&this.q.valueOf()==t.q.valueOf():this.value()==t.value()}add(t){return t instanceof l?new l(this.p*t.q+t.p*this.q,this.q*t.q):p(t)?new l(this.p+t*this.q,this.q):new o(this.value()+t)}subtract(t){return t instanceof l?new l(this.p*t.q-t.p*this.q,this.q*t.q):p(t)?new l(this.p-t*this.q,this.q):new o(this.value()-t)}multiply(t){return t instanceof l?new l(this.p*t.p,this.q*t.q):p(t)?new l(this.p*t,this.q):new o(this.value()*t)}divide(t){return t instanceof l?new l(this.p*t.q,this.q*t.p):p(t)?new l(this.p,this.q*t):new o(this.value()/t)}addInverse(){return new l(-this.p,this.q)}multInverse(){return 0!=this.p?new l(this.q,this.p):new o(NaN)}toString(t){void 0===t&&(t=!1);var e=t&&this.p>0?"+":"";return isNaN(this.p)?e="NaN":1==this.q?e+=this.p:e=e+this.p+"/"+this.q,e}toTeX(t){void 0===t&&(t=!1);var e=t&&this.p>0?"+":"";return isNaN(this.p)?e="\\mathrm{NaN}":1==this.q?e+=this.p:e=this.p<0?"-\\frac{"+-this.p+"}{"+this.q+"}":e+"\\frac{"+this.p+"}{"+this.q+"}",e}toMathML(){return"undefined"==typeof leadSign&&(leadSign=!1),this.p,this.q,"<cn>"+this.toString()+"</cn>"}}class c extends h{constructor(t){super(),this.type=x.number,"number"==typeof t||t instanceof Number?Math.floor(t)==t?this.number=new l(t,1):this.number=new o(t):t instanceof o?this.number=t:t instanceof c?this.number=t.number:console.log("Trying to instantiate a scalar_expr with a non-number object: "+t),this.context="number"}toString(t){return void 0===t&&(t=!1),this.number.toString()}toTeX(t){void 0===t&&(t=!1);var e=this.number.toTeX();return t&&this.select&&(e="{\\color{red}"+e+"}"),e}toMathML(){return"<cn>"+this.toString()+"</cn>"}allStringEquivs(){return[this.toString()]}isConstant(){return!0}simplifyConstants(t){var e;if(!t.options.negativeNumbers&&this.number.p<0){var s=this.number.multiply(-1);e=new unop_expr("-",new c(s))}else e=this;return e}value(){return this.number.value()}evaluate(t,e){return this.value()}copy(){return new c(this.number)}compose(t){return new c(this.number)}derivative(t,e){return new c(0)}match(t,e){var s=null,i=t;return t.isConstant()&&t.type!=x.number?(i=t.copy().simplifyConstants(),this.toString()===i.toString()&&(s=e)):i.type==x.number&&this.number.equal(i.number)&&(s=e),s}}class v extends h{constructor(t){super(),this.type=x.variable,this.name=t;var e=t.indexOf("'");switch(this.derivs=0,e>0&&(this.derivs=t.slice(e).length),this.isConst=!1,this.isSpecial=!1,this.name){case"e":case"pi":case"dne":case"inf":this.isConst=!0,this.isSpecial=!0}}toString(t){return void 0===t&&(t=!1),this.name}allStringEquivs(){return[this.toString()]}toTeX(t){void 0===t&&(t=!1);var e=this.toString();switch(this.name){case"alpha":case"beta":case"gamma":case"delta":case"epsilon":case"zeta":case"eta":case"theta":case"kappa":case"lambda":case"mu":case"nu":case"xi":case"pi":case"rho":case"sigma":case"tau":case"upsilon":case"phi":case"chi":case"psi":case"omega":case"Gamma":case"Delta":case"Theta":case"Lambda":case"Xi":case"Pi":case"Sigma":case"Upsilon":case"Phi":case"Psi":case"Omega":e="\\"+this.name;break;case"inf":e="\\infty";break;default:this.isSpecial&&(e="\\mathrm{"+this.name+"}")}return 0==this.name.indexOf("input")&&(e="\\boxed{\\dots?^{"+this.name.slice(5)+"}}"),t&&this.select&&(e="{\\color{red}"+e+"}"),e}dependencies(t){var e=new Array;if(null!=t)for(var s=0;s<t.length;s++)e.push(t[s]);return!this.isConst&&e.indexOf(this.name)<0&&e.push(this.name),e}isConstant(){return this.isConst}evaluate(t,e){var s;if(null==e[this.name])switch(this.name){case"e":s=Math.E;break;case"pi":s=Math.PI;break;case"inf":s=1/0;break;case"dne":s=Number.NaN;break;default:console.log("Variable evaluated without binding.")}else s="function"==typeof e[this.name].value?e[this.name].value():e[this.name];return s}copy(){return new v(this.name)}compose(t){return null==t[this.name]?new v(this.name):t[this.name]}derivative(t,e){var s="string"==typeof t?t:t.name;return this.name===s?new c(1):this.isConst||e&&null!=e[this.name]?new c(0):new v(this.name+"'")}match(t,e){var s=null;return this.isConst?t.toString()===this.name&&(s=e):null!=e&&null==e[this.name]&&t.valueType==M.numeric?(s=e)[this.name]=t.toString():null!=e&&e[this.name]==t.toString()&&(s=e),s}}class d{constructor(t,e){this.type=x.variable,this.name=t,this.select=!1,this.boundName="[]"+t,this.parent=null,this.index=e;var s=e.dependencies();s.length>1?alert("An array reference can only have one index variable."):this.k=s[0]}toString(t){return void 0===t&&(t=!1),this.name+"["+this.index.toString()+"]"}toTeX(t){return void 0===t&&(t=!1),word=this.name+"_{"+this.index.toString()+"}",t&&this.select&&(word="{\\color{red}"+word+"}"),word}toMathML(){return'<apply><selector/><ci type="vector">'+this.name+"</ci>"+this.index.toString()+"</apply>"}dependencies(t){var e=new Array;if(null!=t)for(var s=0;s<t.length;s++)e.push(t[s]);return this.name,e.push("row"),e.push(this.boundName),e}evaluate(t,e){var s;if(null==e[this.boundName])this.name,s=void 0;else{var i={};null!=this.k&&(i[this.k]=e.row);var n=this.index.evaluate(t,i)-1;n>=0&&n<e[this.boundName].length&&(s=e[this.boundName][n])}return s}}class f extends h{constructor(t,e,s){switch(super(),this.type=x.binop,this.op=t,void 0===e&&(e=new h),void 0===s&&(s=new h),this.inputs=[e,s],e.parent=this,s.parent=this,t){case"+":case"-":this.prec=k.addsub;break;case"*":case"/":this.prec=k.multdiv;break;case"^":this.prec=k.power;break;case"&":this.prec=k.conj,this.valueType=M.bool;break;case"$":this.prec=k.disj,this.valueType=M.bool;break;case"=":this.prec=k.equal,this.valueType=M.bool;break;default:console.log("Unknown binary operator: '"+t+"'.")}}toString(){var t,e;void 0===this.inputs[0]?t="?":(t=this.inputs[0].toString(),(this.inputs[0].type>=x.unop&&this.inputs[0].prec<this.prec||this.inputs[0].type==x.number&&t.indexOf("/")>=0&&k.multdiv<=this.prec)&&(t="("+t+")")),void 0===this.inputs[1]?e="?":(e=this.inputs[1].toString(),(this.inputs[1].type>=x.unop&&this.inputs[1].prec<=this.prec||this.inputs[1].type==x.number&&e.indexOf("/")>=0&&k.multdiv<=this.prec)&&(e="("+e+")"));var s=this.op;return"|"==s&&(s=" $ "),t+s+e}allStringEquivs(){var t=this.inputs[0].allStringEquivs(),e=this.inputs[1].allStringEquivs(),s=[],i=this.op;for(var n in"|"==i&&(i=" $ "),t)for(var r in e)opAStr=t[n],this.inputs[0].type>=x.unop&&this.inputs[0].prec<this.prec&&(opAStr="("+opAStr+")"),opBStr=e[r],this.inputs[1].type>=x.unop&&this.inputs[1].prec<=this.prec&&(opBStr="("+opBStr+")"),s.push(opAStr+i+opBStr),"+"!=this.op&&"*"!=this.op&&"&"!=this.op&&"$"!=this.op||(opBStr=e[r],this.inputs[1].type>=x.unop&&this.inputs[1].prec<this.prec&&(opBStr="("+opBStr+")"),opAStr=t[n],this.inputs[0].type>=x.unop&&this.inputs[0].prec<=this.prec&&(opAStr="("+opAStr+")"),s.push(opBStr+i+opAStr));return s}toTeX(t){var e,s,i,n;if(void 0===t&&(t=!1),i=void 0===this.inputs[0]?"?":this.inputs[0].toTeX(t),n=void 0===this.inputs[1]?"?":this.inputs[1].toTeX(t),s=this.op,t&&this.select)switch(s){case"*":s="\\cdot ";break;case"/":s="\\div ";break;case"^":s="\\wedge ";break;case"|":case"$":s="\\hbox{ or }";break;case"&":s="\\hbox{ and }"}else switch(s){case"*":s=this.inputs[1]&&this.inputs[1].type==x.number||this.inputs[1]&&this.inputs[1].type==x.binop&&"^"==this.inputs[1].op&&this.inputs[1].inputs[0].type==x.number?"\\cdot ":" ";break;case"|":case"$":s="\\hbox{ or }";break;case"&":s="\\hbox{ and }"}if("/"==s)e="\\frac{"+i+"}{"+n+"}";else if("^"==s)e=this.inputs[0]&&this.inputs[0].type>=x.fcn?"\\left("+i+"\\right)":i,e+=s+"{"+n+"}";else{var r="",a="",u="",h="";t&&this.select&&(r="{\\color{blue}",a="}",u="{\\color{red}",h="}"),e=this.inputs[0]&&this.inputs[0].type>=x.unop&&this.inputs[0].prec<this.prec?"\\left("+r+i+a+"\\right)":r+i+a,e+=u+s+h,this.inputs[1]&&this.inputs[1].type>=x.unop&&this.inputs[1].prec<=this.prec?e+="\\left("+r+n+a+"\\right)":e+=r+n+a}return t&&this.select&&(e="{\\color{red}\\boxed{"+e+"}}"),e.replace(/\+-/g,"-")}toMathML(){var t,e,s;switch(e=void 0===this.inputs[0]?"?":this.inputs[0].toMathML(),s=void 0===this.inputs[1]?"?":this.inputs[1].toMathML(),this.op){case"+":t="<plus/>";break;case"-":t="<minus/>";break;case"*":t="<times/>";break;case"/":t="<divide/>";break;case"^":t="<power/>"}return"<apply>"+t+e+s+"</apply>"}operateToTeX(){var t=this.op;switch(t){case"*":t="\\times ";break;case"/":t="\\div ";break;case"^":t="\\wedge ";break;case"|":case"$":t="\\hbox{ or }";break;case"&":t="\\hbox{ and }"}return t}isCommutative(){var t=!1;return"+"!==this.op&&"*"!==this.op||(t=!0),t}evaluate(t,e){var s=this.inputs[0].evaluate(t,e),i=this.inputs[1].evaluate(t,e);if(null!=s&&null!=i){var n=void 0;switch(this.op){case"+":n=s+i;break;case"-":n=s-i;break;case"*":n=s*i;break;case"/":n=s/i;break;case"^":n=this.inputs[1].isConstant()&&(s>=0||i%1==0)?Math.pow(s,i):Math.exp(i*Math.log(s));break;case"=":n=Math.abs(s-i)<this.btm.options.absTol;break;case"&":n=s&&i;break;case"|":case"$":n=s||i;break;default:console.log("The binary operator '"+this.op+"' is not defined."),n=void 0}return n}}reduce(t){var e=this;return this.inputs.length<=1&&((e=0==this.inputs.length?new c("+"==this.op?0:1):this.inputs[0].reduce(t)).parent=this.parent,null!==this.parent&&this.parent.inputSubst(this,e)),e}simplifyConstants(t){var e=this;if(this.inputs[0]=this.inputs[0].simplifyConstants(t),this.inputs[0].parent=this,this.inputs[1]=this.inputs[1].simplifyConstants(t),this.inputs[1].parent=this,(this.inputs[0].type==x.number||this.inputs[0].type==x.unop&&this.inputs[0].inputs[0].type==x.number)&&(this.inputs[1].type==x.number||this.inputs[1].type==x.unop&&this.inputs[1].inputs[0].type==x.number)){var s,i,n;if(this.inputs[0].type==x.number)s=this.inputs[0].number;else switch(this.inputs[0].op){case"-":s=this.inputs[0].inputs[0].number.addInverse();break;case"/":s=this.inputs[0].inputs[0].number.multInverse()}if(this.inputs[1].type==x.number)i=this.inputs[1].number;else switch(this.inputs[1].op){case"-":i=this.inputs[1].inputs[0].number.addInverse();break;case"/":i=this.inputs[1].inputs[0].number.multInverse()}switch(this.op){case"+":n=s.add(i);break;case"-":n=s.subtract(i);break;case"*":n=s.multiply(i);break;case"/":n=s.divide(i);break;case"^":s instanceof rational_number&&i instanceof rational_number&&1==i.q&&i.p%1==0&&i.p>0&&(n=new rational_number(Math.pow(s.p,i.p),Math.pow(s.q,i.p)))}void 0!==n&&(e=!this.btm.options.negativeNumbers&&n.p<0?new b("-",new c(n.multiply(-1))):new c(n))}else switch(this.op){case"+":this.inputs[0].type==x.number&&0==this.inputs[0].number.value()?e=this.inputs[1]:this.inputs[1].type==x.number&&0==this.inputs[1].number.value()&&(e=this.inputs[0]);break;case"-":this.inputs[0].type==x.number&&0==this.inputs[0].number.value()?e=new b("-",this.inputs[1]):this.inputs[1].type==x.number&&0==this.inputs[1].number.value()&&(e=this.inputs[0]);break;case"*":this.inputs[0].type==x.number&&1==this.inputs[0].number.value()?e=this.inputs[1]:this.inputs[1].type==x.number&&1==this.inputs[1].number.value()&&(e=this.inputs[0]);break;case"/":this.inputs[0].type==x.number&&1==this.inputs[0].number.value()?e=new b("/",this.inputs[1]):this.inputs[1].type==x.number&&1==this.inputs[1].number.value()&&(e=this.inputs[0]);break;case"^":this.inputs[0].type==x.number&&0==this.inputs[0].number.value()?e=new c(0):this.inputs[0].type==x.number&&1==this.inputs[0].number.value()?e=new c(1):this.inputs[1].type==x.number&&1==this.inputs[1].number.value()&&(e=this.inputs[0])}return e}flatten(){var t,e=this.inputs[0].flatten(),s=this.inputs[1].flatten();switch(this.op){case"+":case"-":var i=[];if(e.type!=x.multiop&&e.type!=x.binop||"+"!=e.op&&"-"!=e.op)i.push(e);else{var n=e.flatten();for(var r in n.inputs)i.push(n.inputs[r])}if(s.type!=x.multiop&&s.type!=x.binop||"+"!=s.op&&"-"!=s.op)if("-"==this.op)if(s.type!=x.multiop&&s.type!=x.binop||"+"!=s.op&&"-"!=s.op)i.push(new b("-",s));else for(var r in(n=s.flatten()).inputs)i.push(new b("-",n.inputs[r]));else i.push(s);else{n=s.flatten();for(var r in n.inputs)i.push(n.inputs[r])}t=new multiop_expr("+",i);break;case"*":case"/":if(i=[],e.type!=x.multiop&&e.type!=x.binop||"*"!=e.op&&"/"!=e.op)i.push(e);else for(var r in(n=e.flatten()).inputs)i.push(n.inputs[r]);if(s.type!=x.multiop&&s.type!=x.binop||"*"!=s.op&&"/"!=s.op)if("/"==this.op)if(s.type!=x.multiop&&s.type!=x.binop||"*"!=s.op&&"/"!=s.op)i.push(new b("/",s));else for(var r in(n=s.flatten()).inputs)i.push(new b("/",n.inputs[r]));else i.push(s);else for(var r in(n=s.flatten()).inputs)i.push(n.inputs[r]);t=new multiop_expr("*",i);break;default:t=new f(this.op,e,s)}return t}copy(){var t=this.inputs[0].copy(),e=this.inputs[1].copy();return new f(this.op,t,e)}compose(t){var e,s=this.inputs[0].compose(t),i=this.inputs[1].compose(t);if(e=new f(this.op,s,i),s.type==x.number&&i.type==x.number)switch(this.op){case"+":e=new c(s.number.add(i.number));break;case"-":e=new c(s.number.subtract(i.number));break;case"*":e=new c(s.number.multiply(i.number));break;case"/":e=new c(s.number.divide(i.number))}return e}derivative(t,e){var s,i,n=this.inputs[0].isConstant(),r=this.inputs[1].isConstant();if(n&&r)s=new c(0);else switch(w=n?new c(0):this.inputs[0].derivative(t,e),i=r?new c(0):this.inputs[1].derivative(t,e),this.op){case"+":s=new f("+",w,i);break;case"-":s=new f("-",w,i);break;case"*":var a=new f("*",this.inputs[0],i),u=new f("*",w,this.inputs[1]);s=n?a:r?u:new f("+",u,a);break;case"/":if(r)s=new f("/",w,this.inputs[1]);else if(n){var h=new b("-",new f("*",this.inputs[0],i)),o=new f("^",this.inputs[1],new c(2));s=new f("/",h,o)}else a=new f("*",this.inputs[0],i),u=new f("*",w,this.inputs[1]),h=new f("-",u,a),o=new f("^",this.inputs[1],new c(2)),s=new f("/",h,o);break;case"^":var p=this.inputs[1].dependencies(),l="string"==typeof t?t:t.name;if(p.length>0&&p.indexOf(l)>=0){var v=new f("*",this.inputs[1],new function_expr("log",this.inputs[0]));s=new function_expr("exp",v).derivative(t,e)}else if(n)s=new c(0);else{var d=new f("-",this.inputs[1],new c(1)),m=new f("*",this.inputs[1],new f("^",this.inputs[0],d));if(this.inputs[0].type==x.variable&&this.inputs[0].name==l)s=m;else{var w=this.inputs[0].derivative(t,e);s=new f("*",m,w)}}break;default:console.log("The binary operator '"+this.op+"' is not defined."),s=void 0}return s}}class b extends h{constructor(t,e){switch(super(),this.type=x.unop,this.op=t,void 0===e&&(e=new h),this.inputs=[e],e.parent=this,t){case"+":case"-":this.prec=k.multdiv;break;case"/":this.prec=k.power;break;default:alert("Unknown unary operator: '"+t+"'.")}}toString(){var t;return t=void 0===this.inputs[0]?"?":this.inputs[0].toString(),this.inputs[0].type>=x.unop&&this.inputs[0].prec<this.prec||this.inputs[0].type==x.number&&t.indexOf("/")>=0&&k.multdiv<=this.prec?this.op+"("+t+")":this.op+t}allStringEquivs(){var t=this.inputs[0].allStringEquivs(),e=[];for(var s in t)this.inputs[0].type>=x.unop&&this.inputs[0].prec<=this.prec?e[s]=this.op+"("+t[s]+")":e[s]=this.op+t[s];return e}toTeX(t){var e,s,i;return void 0===t&&(t=!1),s=void 0===this.inputs[0]?"?":this.inputs[0].toTeX(t),"/"==(i=this.op)?(i="\\div ",e=t&&this.select?"{\\color{red}"+this.op+"}\\left({\\color{blue}"+s+"}\\right)":"\\frac{1}{"+s+"}"):e=t&&this.select?"{\\color{red}"+this.op+"}\\left({\\color{blue}"+s+"}\\right)":this.inputs[0].type>=x.unop&&this.inputs[0].prec<=this.prec&&(this.inputs[0].type!=x.unop||"-"!=this.op||"/"!=this.inputs[0].op)?i+"\\left("+s+"\\right)":i+s,e}toMathML(){var t,e;switch(e=void 0===this.inputs[0]?"?":this.inputs[0].toMathML(),this.op){case"+":t=e;break;case"-":t="<apply><minus/>"+e+"</apply>";break;case"/":t="<apply><divide/><cn>1</cn>"+e+"</apply>"}return t}operateToTeX(){var t=this.op;return"/"===t&&(t="\\div"),t}evaluate(t,e){var s,i=this.inputs[0].evaluate(t,e);if(null!=i){switch(this.op){case"+":s=i;break;case"-":s=-1*i;break;case"/":s=1/i;break;default:alert("The unary operator '"+this.op+"' is not defined."),s=void 0}return s}}simplifyConstants(t){var e;if(this.inputs[0]=this.inputs[0].simplifyConstants(t),this.inputs[0].parent=this,this.inputs[0].type==x.number){var s=this.inputs[0].number;switch(this.op){case"-":e=options.negativeNumbers?new c(s.addInverse()):this;break;case"/":e=new c(s.multInverse())}}else e=this;return e}flatten(){return new b(this.op,this.inputs[0].flatten())}copy(){return new b(this.op,this.inputs[0].copy())}compose(t){return new b(this.op,this.inputs[0].compose(t))}derivative(t,e){var s;if(this.inputs[0].isConstant())s=new c(0);else switch(this.op){case"+":s=this.inputs[0].derivative(t,e);break;case"-":s=new b("-",this.inputs[0].derivative(t,e));break;case"/":var i=new f("*",this.inputs[0],this.inputs[0]);s=new b("-",new f("/",this.inputs[0].derivative(t,e),i));break;default:console.log("The derivative of the unary operator '"+this.op+"' is not defined."),s=void 0}return s}match(t,e){var s=null;if(this.isConstant()&&t.isConstant()){var i=t.simplifyConstants(),n=this.simplifyConstants();(i.toString()===n.toString()||i.type==x.number&&n.type==x.number&&n.number.equal(i.number))&&(s=e)}else s=h.prototype.match.call(this,t,e);return s}}class m extends h{constructor(t,e){for(var s in super(),this.type=x.multiop,this.op=t,this.inputs=e,e)void 0===e[s]&&(e[s]=new h),e[s].parent=this;switch(t){case"+":this.prec=k.addsub;break;case"*":this.prec=k.multdiv;break;default:alert("Unknown multi-operand operator: '"+t+"'.")}}toString(){var t,e;for(var s in t="",this.inputs)void 0===this.inputs[s]?e="?":(e=this.inputs[s].toString(),(this.inputs[s].type>=x.unop&&this.inputs[s].prec<=this.prec||this.inputs[s].type==x.number&&1!=this.inputs[s].number.q&&k.multdiv<=this.prec)&&(e="("+e+")")),t+=(s>0?this.op:"")+e;return t}allStringEquivs(){var t=[],e=[];for(var s in this.inputs)t[s]=this.inputs[s].allStringEquivs(),e.push(s);var i=permutations(e),n=[],r=this.op;function a(e,s){if(void 0===s?s="":e.length>0&&(s+=r),e.length>0){var i=t[e[0]];for(var u in i)a(e.slice(1),s+"("+i[u]+")")}else n.push(s)}for(var s in"|"==r&&(r=" $ "),i)a(i[s]);return n}toTeX(t){var e,s,i,n,r,a,u;void 0===t&&(t=!1),s=this.op,"*"==this.op&&(s=t&&this.select?"\\times":" "),t&&this.select?(n="{\\color{blue}",r="}",a="{\\color{red}",u="}"):(n="",r="",a="",u=""),e="";var h=this.prec;for(var o in this.inputs)void 0===this.inputs[o]?e+=(o>0?a+s+u:"")+(i="?"):"*"!=this.op||this.inputs[o].type!=x.unop||"/"!=this.inputs[o].op||t&&this.select?"+"!=this.op||this.inputs[o].type!=x.unop||"-"!=this.inputs[o].op||t&&this.select?(i=n+this.inputs[o].toTeX(t)+r,(this.inputs[o].type>=x.unop&&this.inputs[o].prec<=h||o>0&&"*"==this.op&&this.inputs[o].type==x.number)&&(i="\\left("+i+"\\right)"),e+=(o>0?a+s+u:"")+i):e+=i=n+this.inputs[o].toTeX(t)+r:(i=n+this.inputs[o].inputs[0].toTeX(t)+r,this.inputs[o].inputs[0].type>=x.unop&&this.inputs[o].inputs[0].prec<h&&(i="\\left("+i+"\\right)"),""==e&&(e="1"),e="\\frac{"+e+"}{"+i+"}");return e}toMathML(){var t,e;switch(this.op){case"+":e="<plus/>";break;case"*":e="<times/>"}for(var s in t="<apply>"+e,this.inputs)t+=void 0===this.inputs[s]?"?":this.inputs[s].toMathML();return t+"</apply>"}operateToTeX(){var t=this.op;return"*"===t&&(t="\\times"),t}isCommutative(){var t=!1;return"+"!==this.op&&"*"!==this.op||(t=!0),t}evaluate(t,e){var s,i;switch(this.op){case"+":for(s in i=0,this.inputs)i+=this.inputs[s].evaluate(t,e);break;case"*":for(s in i=1,this.inputs)i*=this.inputs[s].evaluate(t,e);break;default:console.log("The binary operator '"+this.op+"' is not defined."),i=void 0}return i}flatten(){var t,e=[];for(var s in this.inputs){var i=this.inputs[s].flatten();if(i.type==x.multiop&&i.op==this.op)for(var n in i.inputs)e.push(i.inputs[n]);else e.push(i)}if(0==e.length)t=new c("+"==this.op?0:1);else if(1==e.length)t=e[0];else{var r;if("*"==this.op)for(s=0;s<e.length-1;s++)for(n=s+1;n<e.length;n++)e[s].type>e[n].type&&(r=e[s],e[s]=e[n],e[n]=r);t=new m(this.op,e)}return t}reduce(){var t=this;return this.inputs.length<=1&&((t=0==this.inputs.length?new c("+"==this.op?0:1):this.inputs[0]).parent=this.parent,null!==this.parent&&this.parent.inputSubst(this,t)),t}simplifyConstants(){var t,e=[],s=[];for(t in this.inputs)this.inputs[t]=this.inputs[t].simplifyConstants(),this.inputs[t].parent=this,this.inputs[t].type==x.number?e.push(t):s.push(this.inputs[t]);var i=this;if(e.length>1){var n,r=this.inputs[e[0]].number;for(t=1;t<e.length;t++)switch(this.op){case"+":r=r.add(this.inputs[e[t]].number);break;case"*":r=r.multiply(this.inputs[e[t]].number)}switch(this.op){case"+":s.push(n=new c(r));break;case"*":s.splice(0,0,n=new c(r))}1==s.length?i=s[0]:(n.parent=this,i=new m(this.op,s))}return i}match(t,e){function s(t){var e={};for(var s in t)e[s]=t[s];return e}var i=null,n=this.inputs.length;if(t.type==x.multiop&&this.op==t.op&&n<=t.inputs.length){for(var r,a=[],u=0;u<n;u++)if(u<n-1||t.inputs.length==n)a[u]=t.inputs[u].copy();else{for(var o=[],p=0;p<=t.inputs.length-n;p++)o[p]=t.inputs[n+p-1].copy();a[u]=new m(t.op,o)}if(r=new m(t.op,a),i=s(e),null==(i=h.prototype.match.call(this,r,i))&&n<t.inputs.length){var l=t.inputs.length-n;for(a=[],u=0;u<n;u++)if(0==u){for(o=[],p=0;p<=l;p++)o[p]=t.inputs[p].copy();a[u]=new m(t.op,o)}else a[u]=t.inputs[l+u].copy();r=new m(t.op,a),i=s(e),i=h.prototype.match.call(this,r,i)}}return i}compose(t){var e=[];for(var s in this.inputs)e.push(this.inputs[s].compose(t));return 0==e.length?new c("+"==this.op?0:1):1==e.length?e[0]:new m(this.op,e)}derivative(t,e){var s,i,n=[];for(s in this.inputs)if(!this.inputs[s].isConstant())switch(i=this.inputs[s].derivative(t,e),this.op){case"+":n.push(i);break;case"*":var r=[];for(j in this.inputs)s==j?r.push(i):r.push(this.inputs[j].compose({}));n.push(new m("*",r))}return 0==n.length?new c(0):1==n.length?n[0]:new m("+",n)}}class w extends h{constructor(t,e,s){super(),this.type=x.fcn;var i=t.indexOf("'");switch(this.derivs=0,i>0?(this.name=t.slice(0,i),this.derivs=t.slice(i).length):this.name=t,void 0===e&&(e=new h),this.inputs=[e],e.parent=this,this.domain=s,this.alternate=null,this.builtin=!0,this.name){case"asin":case"acos":case"atan":case"asec":case"acsc":case"acot":this.name="arc"+this.name.slice(1,4);break;case"log":this.name="ln";break;case"sin":case"cos":case"tan":case"csc":case"sec":case"cot":case"arcsin":case"arccos":case"arctan":case"arcsec":case"arccsc":case"arccot":case"sqrt":case"root":case"abs":case"exp":case"expb":case"ln":case"log10":break;default:this.builtin=!1}if(this.builtin&&this.derivs>0){for(var n=new v("x"),r=new w(this.name,n),a=0;a<this.derivs;a++)r=r.derivative(n,{x:0});var u={};u.x=e,this.alternate=r.compose(u)}}getName(){return this.name+"'".repeat(this.derivs)}toString(t){var e,s;if(void 0===t&&(t=!1),e=this.getName(),t)s=e;else{var i=[];if(0==this.inputs.length||void 0===this.inputs[0])i.push("?");else for(var n in this.inputs)i.push(this.inputs[n].toString());s=e+"("+i.join(",")+")"}return s}allStringEquivs(){var t=[],e=[];for(var s in this.inputs)e.push(this.inputs[s].allStringEquivs());var i=[],n=this.getName();for(var s in function e(s,i){if(0==i.length)t.push(s);else{var n=s.length,r=[];for(var a in s)r.push(s[a]);for(var a in i[0])r[n]=i[0][a],e(r,i.slice(1))}}([],e),t)i[s]=n+"("+t[s].join("+")+")";return i}toTeX(t){void 0===t&&(t=!1);var e,s="",i=[];if(void 0===this.inputs[0])i.push("?");else for(var n in this.inputs)i.push(this.inputs[n].toTeX(t)),t&&this.select&&(i[n]="{\\color{blue}"+i[n]+"}");switch(this.name){case"sin":e="\\sin";break;case"cos":e="\\cos";break;case"tan":e="\\tan";break;case"csc":e="\\csc";break;case"sec":e="\\sec";break;case"cot":e="\\cot";break;case"arcsin":e="\\sin^{-1}";break;case"arccos":e="\\cos^{-1}";break;case"arctan":e="\\tan^{-1}";break;case"arccsc":e="\\csc^{-1}";break;case"arcsec":e="\\sec^{-1}";break;case"arccot":e="\\cot^{-1}";break;case"sqrt":e="\\mathrm{sqrt}",s="\\sqrt{"+i[0]+"}";break;case"root":e="\\mathrm{root}",s="\\sqrt["+i[1]+"]{"+i[0]+"}";break;case"abs":e="\\abs",s="\\left|"+i[0]+"\\right|";break;case"exp":e="e^",s="e^{"+i[0]+"}";break;case"expb":e="\\exp";break;case"ln":e="\\ln";break;case"log10":e="\\log_{10}";break;default:e=this.name.length>1?"\\mathrm{"+this.name+"}":this.name}return this.derivs>0&&(this.derivs<=3?e+="'".repeat(this.derivs):e=e+"^{("+this.derivs+")}"),t&&this.select&&(e="\\color{red}{"+e+"}",s=""),""==s&&(s=e+" \\mathopen{}\\left("+i.join(",")+"\\right)\\mathclose{}"),s}toMathML(){var t,e;switch(e=void 0===this.inputs[0]?"?":this.inputs[0].toMathML(),this.name){case"sin":case"cos":case"tan":case"csc":case"sec":case"cot":case"arcsin":case"arccos":case"arctan":case"exp":case"expb":case"ln":case"abs":t="<apply><"+this.name+"/>"+e+"</apply>";break;case"sqrt":t="<apply><root/>"+e+"</apply>";break;case"log10":t="<apply><log/><logbase><cn>10</cn></logbase>"+e+"</apply>";break;default:t="<apply><ci>"+this.name+"</ci>"+e+"</apply>"}return t}operateToTeX(){var t;switch(this.name){case"sin":t="\\sin";break;case"cos":t="\\cos";break;case"tan":t="\\tan";break;case"csc":t="\\csc";break;case"sec":t="\\sec";break;case"cot":t="\\cot";break;case"arcsin":t="\\sin^{-1}";break;case"arccos":t="\\cos^{-1}";break;case"arctan":t="\\tan^{-1}";break;case"arccsc":t="\\csc^{-1}";break;case"arcsec":t="\\sec^{-1}";break;case"arccot":t="\\cot^{-1}";break;case"sqrt":t="\\mathrm{sqrt}";break;case"abs":t="\\abs";break;case"exp":case"expb":t="\\exp";break;case"ln":t="\\ln";break;case"log10":t="\\log_{10}";break;default:t=this.name.length>1?"\\mathrm{"+this.name+"}":this.name}return this.derivs>0&&(this.derivs<=3?t+="'".repeat(this.derivs):t=t+"^{("+this.derivs+")}"),t+"(\\Box)"}evaluate(t,e){var s=this.inputs[0].evaluate(t,e),i=void 0;if(null!=s){if(this.builtin&&this.derivs>0)null!=this.alternate?i=this.alternate.evaluate(t,e):console.log("Error: Built-in function called with unspecified derivative formula.");else if(null==e[this.name])switch(this.name){case"sin":i=Math.sin(s);break;case"cos":i=Math.cos(s);break;case"tan":i=Math.tan(s);break;case"csc":i=1/Math.sin(s);break;case"sec":i=1/Math.cos(s);break;case"cot":i=1/Math.tan(s);break;case"arcsin":Math.abs(s)<=1&&(i=Math.asin(s));break;case"arccos":Math.abs(s)<=1&&(i=Math.acos(s));break;case"arctan":i=Math.atan(s);break;case"arccsc":Math.abs(s)>=1&&(i=Math.asin(1/s));break;case"arcsec":Math.abs(s)>=1&&(i=Math.acos(1/s));break;case"arccot":i=0==s?Math.PI/2:Math.PI/2-Math.atan(1/s);break;case"sqrt":s>=0&&(i=Math.sqrt(s));break;case"abs":i=Math.abs(s);break;case"exp":case"expb":i=Math.exp(s);break;case"ln":s>0&&(i=Math.log(s));break;case"log10":s>0&&(i=Math.LOG10E*Math.log(s));break;default:null==(o=t.functions[this.name])&&console.log("Error: A custom function never had a backend definition.");var n={};Object.keys(e).forEach((function(t){n[t]=e[t]}));var r=o.input;if(Array.isArray(r)&&console.log("Error: Function is defined to expect multiple inputs. Not yet implemented."),n[r]=s,this.derivs>=o.value.length){(h={})[u=new v(r)]=0;for(var a=o.value.length;a<=this.derivs;a++)o.value[a]=o.value[a-1].derivative(u,h)}i=o.value[this.derivs].evaluate(t,n)}else{var u,h,o=e[this.name];if(n={},Object.keys(e).forEach((function(t){n[t]=e[t]})),r=o.input,Array.isArray(r)&&console.log("Error: Function is defined to expect multiple inputs. Not yet implemented."),n[r]=s,this.derivs>=o.value.length)for((h={})[u=new v(r)]=0,a=o.value.length;a<=this.derivs;a++)o.value[a]=o.value[a-1].derivative(u,h);i=o.value[this.derivs].evaluate(t,n)}return i}}flatten(){return new w(this.getName(),this.inputs[0].flatten())}copy(){return new w(this.getName(),this.inputs[0].copy())}compose(t){return new w(this.getName(),this.inputs[0].compose(t))}derivative(t,e){for(var s,i=this.inputs[0].dependencies(),n=!0,r="string"==typeof t?t:t.name,a=0;a<i.length;a++)i[a]==r&&(n=!1);if(n)s=new c(0);else{var u;switch(this.name){case"sin":u=new w("cos",this.inputs[0]);break;case"cos":u=new b("-",new w("sin",this.inputs[0]));break;case"tan":var h=new w("sec",this.inputs[0]);u=new f("^",h,new c(2));break;case"csc":var o=new w("cot",this.inputs[0]);u=new b("-",new f("*",this,o));break;case"sec":var p=new w("tan",this.inputs[0]);u=new f("*",this,p);break;case"cot":var l=new w("csc",this.inputs[0]);u=new b("-",new f("^",l,new c(2)));break;case"arcsin":var v=new f("-",new c(1),new f("^",this.inputs[0],new c(2)));u=new f("/",new c(1),new w("sqrt",v));break;case"arccos":var d=new f("-",new c(1),new f("^",this.inputs[0],new c(2)));u=new f("/",new c(-1),new w("sqrt",d));break;case"arctan":var m=new f("^",this.inputs[0],new c(2));u=new f("/",new c(1),new f("+",new c(1),m));break;case"arcsec":var y=new f("^",this.inputs[0],new c(2)),g=new f("-",y,new c(1));u=new f("/",new c(1),new f("*",new w("abs",this.inputs[0]),new w("sqrt",g)));break;case"arccsc":y=new f("^",this.inputs[0],new c(2)),g=new f("-",y,new c(1)),u=new f("/",new c(-1),new f("*",new w("abs",this.inputs[0]),new w("sqrt",g)));break;case"arccot":var k=new f("^",this.inputs[0],new c(2));u=new f("/",new c(-1),new f("+",new c(1),k));break;case"sqrt":u=new f("/",new c(1),new f("*",new c(2),this));break;case"abs":u=new f("/",this,this.inputs[0]);break;case"exp":case"expb":u=new w(this.name,this.inputs[0]);break;case"ln":u=new f("/",new c(1),this.inputs[0]);break;case"log10":u=new f("/",new c(Math.LOG10E),this.inputs[0]);break;default:u=new w(this.getName()+"'",this.inputs[0])}if(n||this.inputs[0].type!=x.variable){var M=this.inputs[0].derivative(t,e);s=null==M?void 0:new f("*",u,M)}else s=u}return s}}class y extends h{constructor(t,e,s){super(),this.type=x.operator,this.op="D",void 0===t&&(t=new h),void 0===e?e=new v("x"):"string"==typeof e&&(e=new v(e)),this.ivar=e,this.ivarValue=s,this.inputs=[t],this.isRate=!1,t.parent=this}toString(){var t,e;return e=this.ivar.toString(),t=this.inputs[0].toString(),void 0!==this.ivarValue?"D("+t+","+e+","+this.ivarValue.toString()+")":"D("+t+","+e+")"}toTeX(t){var e,s;return e=this.ivar.toTeX(),s=this.inputs[0].toTeX(),this.isRate&&this.inputs[0].type==x.variable?void 0!==this.ivarValue?"\\left. \\frac{d"+s+"}{d"+e+"} \\right|_{"+e+"="+this.ivarValue.toTeX()+"}":"\\frac{d"+s+"}{d"+e+"}":(void 0!==this.ivarValue?"\\left. \\frac{d}{d"+e+"} \\right|_{"+e+"="+this.ivarValue.toTeX()+"}":"\\frac{d}{d"+e+"}")+"\\Big["+s+"\\Big]"}allStringEquivs(){var t,e,s=this.inputs[0].allStringEquivs(),i=[];for(var n in t=this.ivar.toString(),void 0!==this.ivarValue&&(e=this.ivarValue.toString()),s)void 0!==this.ivarValue?i[n]="D("+s[n]+","+t+","+e+")":i[n]="D("+s[n]+","+t+")";return s}toMathML(){return"<apply><derivative/>"+(void 0===this.inputs[0]?"?":this.inputs[0].toMathML())+"</apply>"}evaluate(t,e){var s={};return void 0!==this.ivarValue&&(s[this.ivar.name]=this.ivarValue),this.inputs[0].derivative(this.ivar,e).compose(s).evaluate(t,e)}simplifyConstants(t){return this}flatten(){return new y(this.inputs[0].flatten(),this.ivar,this.ivarValue)}copy(){return new y(this.inputs[0].copy(),this.ivar,this.ivarValue)}compose(t){}derivative(t,e){var s={};void 0!==this.ivarValue&&(s[this.ivar]=this.ivarValue);var i=this.inputs[0].derivative(this.ivar,e);return i.compose(s),i.derivative(t,e)}}class g{constructor(t){if(t.rand)this.rand=t.rand;else{let e;e=null==t.seed?(new Date).getTime().toString():t.seed,this.rand=function(){return function(t){const e="aleaPRNG 1.1.0";var s,i,n,r,a,u=new Uint32Array(3),h="";function o(t){var e=function(){var t=4022871197,e=function(e){for(var s=0,i=(e=e.toString()).length;s<i;s++){var n=.02519603282416938*(t+=e.charCodeAt(s));n-=t=n>>>0,t=(n*=t)>>>0,t+=4294967296*(n-=t)}return 2.3283064365386963e-10*(t>>>0)};return e.version="Mash 0.9",e}();s=e(" "),i=e(" "),n=e(" "),r=1;for(var a=0;a<t.length;a++)(s-=e(t[a]))<0&&(s+=1),(i-=e(t[a]))<0&&(i+=1),(n-=e(t[a]))<0&&(n+=1);h=e.version,e=null}function p(t){return parseInt(t,10)===t}var l=function(){var t=2091639*s+2.3283064365386963e-10*r;return s=i,i=n,n=t-(r=0|t)};return l.fract53=function(){return l()+11102230246251565e-32*(2097152*l()|0)},l.int32=function(){return 4294967296*l()},l.cycle=function(t){(t=void 0===t?1:+t)<1&&(t=1);for(var e=0;e<t;e++)l()},l.range=function(){var t,e;return 1===arguments.length?(t=0,e=arguments[0]):(t=arguments[0],e=arguments[1]),arguments[0]>arguments[1]&&(t=arguments[1],e=arguments[0]),p(t)&&p(e)?Math.floor(l()*(e-t+1))+t:l()*(e-t)+t},l.restart=function(){o(a)},l.seed=function(){o(Array.prototype.slice.call(arguments))},l.version=function(){return e},l.versions=function(){return e+", "+h},0===t.length&&(window.crypto.getRandomValues(u),t=[u[0],u[1],u[2]]),a=t,o(t),l}(Array.prototype.slice.call(arguments))}(e)}}setSeed(t){this.alea.seed(t.toString())}random(){return this.rand()}randSign(){return 2*Math.floor(2*this.random())-1}randInt(t,e){return t+Math.floor((e-t+1)*this.random())}randUniform(t,e){return t+(e-t)*this.random()}randChoice(t,e,s){var i,n,r=new Array,a=new Array;for(i=0;i<=e-t;i++)r[i]=t+i;for(i=0;i<s;i++)n=Math.floor((e-t+1-i)*this.random()),a[i]=r.splice(n,1)[0];return a}randRational(t,e){var s,i;return s=this.randInt(t[0],t[1]),i=this.randInt(e[0],e[1]),new l(s,i)}randHexHash(t){for(var e="",s=0;s<t;s++)e+="0123456789abcdef"[this.randInt(0,15)];return e}}const k={disj:0,conj:1,equal:2,addsub:3,multdiv:4,power:5,fcn:6,fop:7},x={number:0,variable:1,fcn:2,unop:3,binop:4,multiop:5,operator:6,array:7,matrix:8},M={undef:-1,bool:0,numeric:1};function T(t){return"function"==typeof t.toTeX?t.toTeX():t}class S{constructor(t){void 0===t&&((t={}).seed="1234"),this.randomBindings={},this.bindings={},this.data={},this.data.allValues={},this.data.params={},this.data.variables={},this.data.expressions={},this.data.functions={},this.opPrec=k,this.exprType=x,this.exprValue=M,this.options={negativeNumbers:!0,absTol:1e-8,relTol:1e-4,useRelErr:!0,doFlatten:!1},this.setReductionRules(),this.multiop_expr=m,this.binop_expr=f;let e={};void 0!==t.rand&&(e.rand=t.rand),void 0!==t.seed&&(e.seed=t.seed),this.rng=new g(e)}numberCmp(t,e,s){var i,n,r=this.options.useRelErr,a=this.options.relTol,u=this.options.absTol;return i="number"==typeof t||"Number"==typeof t?t:t.value(),n="number"==typeof e||"Number"==typeof e?e:e.value(),void 0!==s&&(void 0!==s.useRelErr&&(r=s.useRelErr),void 0!==s.relTol&&(a=s.relTol),void 0!==s.absTol&&(u=s.absTol)),!r||Math.abs(i)<u?Math.abs(n-i)<u?0:i<n?-1:1:Math.abs(n-i)/Math.abs(i)<a?0:i<n?-1:1}setReductionRules(){var t,e;this.reduceRules=(r(t=this,e=new Array,"0+x==x","Additive Identity",!0,!0),r(t,e,"x+0==x","Additive Identity",!0,!0),r(t,e,"0-x==-x","Additive Inverse",!0,!0),r(t,e,"x-0==x","Additive Identity",!0,!0),r(t,e,"0*x==0","Multiply by Zero",!0,!0),r(t,e,"x*0==0","Multiply by Zero",!0,!0),r(t,e,"1*x==x","Multiplicative Identity",!0,!0),r(t,e,"x*1==x","Multiplicative Identity",!0,!0),r(t,e,"0/x==0","Multiply by Zero",!0,!0),r(t,e,"x/1==x","Divide by One",!0,!0),r(t,e,"x^1==x","First Power",!0,!0),r(t,e,"x^0==1","Zero Power",!0,!0),r(t,e,"x^(-a)==1/(x^a)","Negative Power",!0,!0),r(t,e,"1^x==1","One to a Power",!0,!0),r(t,e,"-1*x==-x","Multiplicative Identity",!0,!0),r(t,e,"x*-1==-x","Multiplicative Identity",!0,!0),r(t,e,"x-x==0","Additive Inverses Cancel",!0,!0),r(t,e,"x+-x==0","Additive Inverses Cancel",!0,!0),r(t,e,"-x+x==0","Additive Inverses Cancel",!0,!0),r(t,e,"(-x)+y==y-x","Swap Leading Negative",!0,!0),r(t,e,"x+(-y)==x-y","Subtraction",!0,!0),r(t,e,"(-x)+(-y)==-(x+y)","Factor Negation from Addition",!0,!0),r(t,e,"(-x)-y==-(x+y)","Factor Negation from Addition",!0,!0),r(t,e,"x-(-y)==x+y","Additive Inverse's Inverse",!0,!0),r(t,e,"(-x)*y==-(x*y)","Factor Negation from Multiplication",!0,!0),r(t,e,"x*(-y)==-(x*y)","Factor Negation from Multiplication",!0,!0),r(t,e,"(-x)/y==-(x/y)","Factor Negation from Multiplication",!0,!0),r(t,e,"x/(-y)==-(x/y)","Factor Negation from Multiplication",!0,!0),r(t,e,"-(-x)==x","Additive Inverse's Inverse",!0,!0),r(t,e,"/(/x)==x","Multiplicative Inverse's Inverse",!0,!0),e)}addReductionRule(t,e,s){r(this,this.reduceRules,t,e,!0,s)}disableReductionRule(t){!function(t,e,s){var i,n=s.split("==");if(n.length>2)console.log("Invalid equation in identity list: "+s);else for(var r in i=t.parse(n[0],"formula"),e)null!==e[r].refExpr.match(i,{})&&(e[r].isActive=!1)}(this,this.reduceRules,t)}addRule(t,e,s,i){r(this,t,e,s,!0,i)}findMatchRules(t,e,s){return a(t,e)}addMathObject(t,e,s){switch(e){case"number":if(!s.isConstant())throw`Attempt to add math object '${t}' with context '${e}' that does not match.`;this.data.params[t]=s,this.data.allValues[t]=s;break;case"formula":this.data.allValues[t]=s}return s}generateRandom(t,e){var s;if("discrete"===t){let t=e.min;"function"==typeof t.value&&(t=t.value());let i=e.max;"function"==typeof i.value&&(i=i.value());let n=e.by;"function"==typeof n.value&&(n=n.value());let r=Math.floor((i-t)/n)+1;do{s=t+n*this.rng.randInt(0,r-1)}while(e.nonzero&&Math.abs(s)<this.options.absTol)}return new c(s)}addParameter(t,e){var s;let i=e.prec;if("random"===e.mode){let t=e.distr;if(void 0===t&&(t="discrete_range"),"discrete_range"===t){let t=e.min;"function"==typeof t.value&&(t=t.value());let i=e.max;"function"==typeof i.value&&(i=i.value());let n=e.by;"function"==typeof n.value&&(n=n.value());let r=Math.floor((i-t)/n)+1;do{s=t+n*this.rng.randInt(0,r-1)}while(e.nonzero&&Math.abs(s)<this.options.absTol)}}else"calculate"==e.mode?s=this.parse(e.formula,"formula").evaluate(this,this.data.params):"rational"==e.mode?s=this.parse(new rational_number(e.numer,e.denom).toString(),"number"):"static"==e.mode&&(s=e.value);return"number"==typeof i&&(s=Math.round(s/i)/Math.round(1/i)),this.data.params[t]=s,this.data.allValues[t]=s,s}addVariable(t,e){var s=new v(t);return this.data.variables[t]=s,this.data.allValues[t]=s,s}evaluateMathObject(t,e,s){var i,n;if("string"==typeof t){var r=this.decodeFormula(t);i=this.parse(r,"formula")}else"object"==typeof t&&(i=t);return n=i.evaluate(this,s),new c(n)}parseExpression(t,e){var s;if("string"==typeof t){var i=this.decodeFormula(t);s=this.parse(i,e)}else"object"==typeof t&&(s=t);return s}composeExpression(t,e){var s,i,n=t,r=Object.entries(e);[s,i]=r[0],"string"==typeof n&&(n=this.parse(n,"formula")),"string"==typeof i&&(i=this.parse(i,"formula"));var a={};return a[s]=i,n.compose(a)}addExpression(t,e){var s=this.parseExpression(e,"formula");return this.data.expressions[t]=s,this.data.allValues[t]=s,s}addFunction(t,e,s){if(arguments.length<2&&(e="x"),arguments.length<3){for(var i,n=new c(this.rng.randRational([-20,20],[1,15])),r=1;r<=6;r++){if(Array.isArray(e)){i=this.parse("sin("+r+"*"+e[0]+")","formula");for(var a=1;a<e.length;a++)i=new f("*",this.parse("sin("+r+"*"+e[a]+")","formula"),i)}else i=this.parse("sin("+r+"*"+e+")","formula");i=new f("*",new c(this.rng.randRational([-20,20],[1,10])),i),n=new f("+",n,i)}s=n}var u={};u.input=e,u.value=s,this.functions[t]=u}decodeFormula(t,e){var s={},i=t.match(/\{\{[A-Za-z]\w*\}\}/g);if(null!=i)for(var n=0;n<i.length;n++){var r=i[n];r=r.substr(2,r.length-4),null!=this.data.allValues[r]&&(s[r]=null!=e&&e?"{"+this.data.allValues[r].toTeX()+"}":"("+this.data.allValues[r].toString()+")")}var a=t;for(var u in s){var h=new RegExp("{{"+u+"}}","g"),o=s[u];a=a.replace(h,o)}return a}compareExpressions(t,e){return"string"==typeof t&&(t=this.parse(t,"formula")),"string"==typeof e&&(e=this.parse(e,"formula")),t.compare(this,e)}getParser(t){var e=this,s=t;return function(t){return e.parse(t,s)}}parse(t,e,s,i){arguments.length<2&&(e="formula"),arguments.length<3&&(s={}),arguments.length<4&&(i={});const n=/\d|(\.\d)/,r=/[a-zA-Z]/,a=/[\+\-*/^=\$&]/;var u,o,p=0,l="";o=t.trim();for(var m=!0;m;)m=!1,"("==o.charAt(0)&&E(o,0)+1>=o.length&&(m=!0,o=o.slice(1,-1));var g=new Array,M=new Array;function T(t,e,s,i){for(var n=0;e.length>0&&(n=e.pop(),!i||!(i.type==x.unop||n.prec<i.prec));){var r;if(n.type==x.unop)if(s.length>0){var a=s.pop();r=t.options.negativeNumbers&&a.type==x.number&&"-"==n.op?new c(a.number.multiply(-1)):new b(n.op,a)}else(r=new h).setParsingError("Incomplete formula: missing value for "+n.op);else if(s.length>1){var u=s.pop(),o=s.pop();r=new f(n.op,o,u)}else(r=new h).setParsingError("Incomplete formula: missing value for "+n.op);s.push(r),n=0}0!=n&&e.push(n),i&&e.push(i)}var S,O=-1;for(p=0;p<o.length;p++)if(" "!=o.charAt(p)){if(")"==o.charAt(p))T(this,M,g),S=0,O=-1;else if("("==o.charAt(p)){u=E(o,p);var V=o.slice(p+1,u),P=this.parse(V,e,s);g.push(P),S=0,p=u}else if("|"==o.charAt(p)){u=N(o,p),V=o.slice(p+1,u),P=this.parse(V,e,s);var R=new w("abs",P);g.push(R),S=0,p=u}else if(0==o.substr(p).search(n))u=X(o,p,i),R=new c(new Number(o.slice(p,u))),i&&i.noDecimals&&"."==o.charAt(p)&&R.setParsingError("Whole numbers only. No decimal values are allowed."),g.push(R),S=0,p=u-1;else if(0==o.substr(p).search(r)){u=C(o,p);var j=o.slice(p,u);if(void 0===s[j]){var L=I(j,s);L.isComposite&&(u=p+(j=L.name).length)}if(void 0===s[j]&&"("==o.charAt(u)){var F=E(o,u);if("D"==j){var _,B,$,D=o.slice(u+1,F).split(",");_=this.parse(D[0],e,s),1==D.length?R=new y(_,"x"):(B=this.parse(D[1],e,s),D.length>2&&($=this.parse(D[2],e,s)),R=new y(_,B,$))}else P=this.parse(o.slice(u+1,F),e,s),R=new w(j,P);g.push(R),S=0,p=F}else if("["==o.charAt(u)){var Z=!1;try{F=A(o,u,!0)}catch(t){l=t,Z=!0,F=u+1}var z=this.parse(o.slice(u+1,F),e,s);R=new d(j,z),Z&&(R.setParsingError(l),l=""),g.push(R),S=0,p=F}else R=new v(j),g.push(R),S=0,p=u-1}else if(0==o.substr(p).search(a)){S=1;var U=o.charAt(p),G=new q(U);0!=O&&("-"==U||"/"==U?(G.type=x.unop,G.prec=k.multdiv):l="Error: consecutive operators"),T(this,M,g,G)}if(0==O&&0==S){var W=g.pop();T(this,M,g,G=new q("*")),g.push(W)}O=S}T(this,M,g);var H=g.pop();return l.length>0?H.setParsingError(l):"number"===e&&(H.isConstant(),H=new c(H.value())),i.doFlatten&&H.flatten(),H}}function q(t){switch(this.op=t,t){case"+":case"-":this.prec=k.addsub,this.type=x.binop,this.valueType=M.numeric;break;case"*":case"/":this.prec=k.multdiv,this.type=x.binop,this.valueType=M.numeric;break;case"^":this.prec=k.power,this.type=x.binop,this.valueType=M.numeric;break;case"&":this.prec=k.conj,this.type=x.binop,this.valueType=M.bool;break;case"$":this.prec=k.disj,this.type=x.binop,this.valueType=M.bool;break;case"=":this.prec=k.equal,this.type=x.binop,this.valueType=M.bool;break;case",":this.prec=k.fop,this.type=x.array,this.valueType=M.vector;break;default:this.prec=k.fcn,this.type=x.fcn}}function N(t,e){for(var s=1,i=e,n=!0;s>0&&i<t.length;)i++,"|"==t.charAt(i)?n?s++:s--:"+-*/([".search(t.charAt(i))>=0?n=!0:" "!=t.charAt(i)&&(n=!1);return i}function E(t,e){for(var s=1,i=e;s>0&&i<t.length;)i++,")"==t.charAt(i)?s--:"("==t.charAt(i)&&s++;return i}function A(t,e,s){for(var i=1,n=e,r=!1;i>0&&n<t.length;)n++,"]"==t.charAt(n)?i--:"["==t.charAt(n)&&(s&&(r=!0),i++);if(s&&r)throw"Nested brackets used for subscripts are not supported.";return n}function C(t,e){return e+t.substr(e).match(/[A-Za-z]\w*'*/)[0].length}function X(t,e,s){var i;return i=s&&s.noDecimals?/[0-9]*/:/[0-9]*(\.[0-9]*)?(e-?[0-9]+)?/,e+t.substr(e).match(i)[0].length}function I(t,e){var s,i=new Object;if(i.isComposite=!1,void 0!==e)if(void 0!==e[t])i.isComposite=!0,i.name=t;else{var n=Object.keys(e);for(var r in n)if(s=n[r],0==t.search(s)&&I(t.slice(s.length),e).isComposite){i.isComposite=!0,i.name=s;break}}return i}}}]);
//# sourceMappingURL=791.js.map