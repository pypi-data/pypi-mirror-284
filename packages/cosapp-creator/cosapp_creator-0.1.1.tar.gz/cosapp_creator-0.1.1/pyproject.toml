[build-system]
build-backend = "hatchling.build"
requires = ["hatchling>=1.5.0,<2", "hatch-nodejs-version>=0.3.2"]

[project]
authors = [
  {name = "Virginie Zell"},
]
classifiers = [
  "Environment :: Web Environment",
  "Framework :: Django",
  "Framework :: Django :: 3.2",
  "Intended Audience :: Developers",
  "License :: OSI Approved :: Apache Software License",
  "Operating System :: OS Independent",
  "Programming Language :: Python",
  "Programming Language :: Python :: 3",
  "Programming Language :: Python :: 3 :: Only",
  "Programming Language :: Python :: 3.8",
  "Programming Language :: Python :: 3.9",
  "Programming Language :: Python :: 3.10",
]
dependencies = [
  "django",
  "djangorestframework",
  "django-cors-headers",
  "cosapp~=0.16"
]
description = "A Django app providing Rest APIs to create CosApp system."
dynamic = ["version"]
homepage = "https://gitlab.com/cosapp/cosapp-utils/cosapp-creator/cosapp-creator-backend"
license = {file = "LICENSE"}
name = "cosapp-creator"
readme = "README.md"

[project.scripts]
cosapp-creator = "cosapp_creator.cli:main"

[tool.hatch.version]
source = "nodejs"

[tool.hatch.build.targets.sdist]
artifacts = ["cosapp_creator/dist"]
exclude = [".github"]

[tool.hatch.build.targets.wheel]
artifacts = ["cosapp_creator/dist"]

[tool.hatch.build.hooks.version]
path = "cosapp_creator/_version.py"

[tool.hatch.build.hooks.jupyter-builder]
build-function = "hatch_jupyter_builder.npm_builder"
dependencies = ["hatch-jupyter-builder>=0.5"]
ensured-targets = ["cosapp_creator/dist/index.html"]
skip-if-exists = [
  "cosapp_creator/dist/index.html",
]

[tool.hatch.build.hooks.jupyter-builder.build-kwargs]
build_cmd = "build:prod"
npm = ["npm"]

[tool.hatch.build.hooks.jupyter-builder.editable-build-kwargs]
build_cmd = "build:prod"
build_dir = "cosapp_creator/static/js"
npm = ["npm"]
source_dir = "src"

[tool.jupyter-releaser.options]
version_cmd = "hatch version"

[tool.jupyter-releaser.hooks]
before-build-npm = ["npm install", "npm run build:prod"]
before-build-python = ["npm run clean"]
before-bump-version = ["python -m pip install hatch"]

[tool.check-wheel-contents]
ignore = ["W002"]
