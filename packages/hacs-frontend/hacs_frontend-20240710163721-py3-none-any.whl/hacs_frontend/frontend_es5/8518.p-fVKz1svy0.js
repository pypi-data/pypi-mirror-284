"use strict";(self.webpackChunkhacs_frontend=self.webpackChunkhacs_frontend||[]).push([[8518],{77222:function(t,r,e){function n(t){var r=t.language||"en";return t.translationMetadata.translations[r]&&t.translationMetadata.translations[r].isRTL||!1}function i(t){return o(n(t))}function o(t){return t?"rtl":"ltr"}e.d(r,{Vc:function(){return i},qC:function(){return n}})},66494:function(t,r,e){var n,i=e(6238),o=e(36683),a=e(89231),s=e(29864),c=e(83647),l=e(8364),u=(e(77052),e(58068)),h=e(5546),d=e(196),f=e(75538);(0,l.A)([(0,d.EM)("ha-button")],(function(t,r){var e=function(r){function e(){var r;(0,a.A)(this,e);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=(0,s.A)(this,e,[].concat(i)),t(r),r}return(0,c.A)(e,r),(0,o.A)(e)}(r);return{F:e,d:[{kind:"field",static:!0,key:"styles",value:function(){return[f.R,(0,h.AH)(n||(n=(0,i.A)(["::slotted([slot=icon]){margin-inline-start:0px;margin-inline-end:8px;direction:var(--direction);display:block}.mdc-button{height:var(--button-height,36px)}.trailing-icon{display:flex}.slot-container{overflow:var(--button-slot-container-overflow,visible)}"])))]}}]}}),u.$)},97836:function(t,r,e){var n=e(1781).A,i=e(94881).A;e.a(t,function(){var t=n(i().mark((function t(n,o){var a,s,c,l,u,h,d,f,p,v,g,_,m,y,k,w,A,b,x,P,z,q,R,C,M,E,D,L,T,I,O,S,F,G,W;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.r(r),e.d(r,{HacsDonwloadDialog:function(){return W}}),a=e(6238),s=e(94881),c=e(1781),l=e(36683),u=e(89231),h=e(29864),d=e(83647),f=e(8364),p=e(77052),e.n(p),v=e(53501),e.n(v),g=e(848),e.n(g),e(58068),_=e(18971),m=e(5546),y=e(196),k=e(45081),w=e(33167),A=e(46531),b=e(77222),e(91074),e(66494),e(88762),e(93259),x=e(31447),P=e(13136),z=e(51285),q=e(93902),R=e(23240),C=e(83503),!(M=n([_])).then){t.next=43;break}return t.next=39,M;case 39:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=44;break;case 43:t.t0=M;case 44:_=t.t0[0],W=(0,f.A)([(0,y.EM)("hacs-download-dialog")],(function(t,r){var e,n,i,o=function(r){function e(){var r;(0,u.A)(this,e);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=(0,h.A)(this,e,[].concat(i)),t(r),r}return(0,d.A)(e,r),(0,l.A)(e)}(r);return{F:o,d:[{kind:"field",decorators:[(0,y.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,y.wk)()],key:"_waiting",value:function(){return!0}},{kind:"field",decorators:[(0,y.wk)()],key:"_installing",value:function(){return!1}},{kind:"field",decorators:[(0,y.wk)()],key:"_error",value:void 0},{kind:"field",decorators:[(0,y.wk)()],key:"_repository",value:void 0},{kind:"field",decorators:[(0,y.wk)()],key:"_dialogParams",value:void 0},{kind:"field",decorators:[(0,y.wk)()],key:"_selectedVersion",value:void 0},{kind:"method",key:"showDialog",value:(i=(0,c.A)((0,s.A)().mark((function t(r){var e=this;return(0,s.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._dialogParams=r,this._waiting=!1,!r.repository){t.next=6;break}this._repository=r.repository,t.next=8;break;case 6:return t.next=8,this._fetchRepository();case 8:return this._repository&&"commit"!==this._repository.version_or_commit&&(this._selectedVersion=this._repository.available_version),(0,q.zl)(this.hass,(function(t){e._error=t,e._installing=!1}),P.a.ERROR),t.next=12,this.updateComplete;case 12:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{kind:"method",key:"closeDialog",value:function(){this._dialogParams=void 0,this._repository=void 0,this._error=void 0,this._installing=!1,this._waiting=!1,(0,w.r)(this,"dialog-closed",{dialog:this.localName})}},{kind:"field",key:"_getInstallPath",value:function(){return(0,k.A)((function(t){var r=t.local_path;return["template","theme","python_script"].includes(t.category)&&(r="".concat(r,"/").concat(t.file_name)),r}))}},{kind:"method",key:"_fetchRepository",value:(n=(0,c.A)((0,s.A)().mark((function t(){return(0,s.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,z.v)(this.hass,this._dialogParams.repositoryId);case 2:this._repository=t.sent;case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{kind:"method",key:"render",value:function(){var t;if(!this._dialogParams||!this._repository)return m.s6;var r=this._getInstallPath(this._repository);return(0,m.qy)(E||(E=(0,a.A)([' <ha-dialog open scrimClickAction escapeKeyAction .heading="','" @closed="','"> <div class="content"> ',' <div class="note"> '," "," "," </div> "," ",' </div> <mwc-button slot="secondaryAction" @click="','" dialogInitialFocus> ',' </mwc-button> <mwc-button slot="primaryAction" ?disabled="','" @click="','"> '," </mwc-button> </ha-dialog> "])),this._repository.name,this.closeDialog,this._repository.can_download?"":(0,m.qy)(D||(D=(0,a.A)(['<ha-alert alert-type="error" .rtl="','"> '," </ha-alert>"])),(0,b.qC)(this.hass),this._dialogParams.hacs.localize("confirm.home_assistant_version_not_correct",{haversion:this.hass.config.version,minversion:this._repository.homeassistant})),this._dialogParams.hacs.localize("dialog_download.note_downloaded",{location:(0,m.qy)(L||(L=(0,a.A)(["<code>'","'</code>"])),r)}),"plugin"===this._repository.category&&"storage"!==this._dialogParams.hacs.info.lovelace_mode?(0,m.qy)(T||(T=(0,a.A)([" <p>","</p> <pre>\n                url: ","\n                type: module\n                </pre> "])),this._dialogParams.hacs.localize("dialog_download.lovelace_instruction"),(0,C.J)({repository:this._repository})):m.s6,"integration"===this._repository.category?(0,m.qy)(I||(I=(0,a.A)(["<p>","</p>"])),this._dialogParams.hacs.localize("dialog_download.restart")):m.s6,null!==(t=this._error)&&void 0!==t&&t.message?(0,m.qy)(O||(O=(0,a.A)(['<ha-alert alert-type="error" .rtl="','"> '," </ha-alert>"])),(0,b.qC)(this.hass),this._error.message):m.s6,this._installing?(0,m.qy)(S||(S=(0,a.A)(["<mwc-linear-progress indeterminate></mwc-linear-progress>"]))):m.s6,this.closeDialog,this._dialogParams.hacs.localize("common.cancel"),!this._repository.can_download||this._waiting||this._installing,this._installRepository,this._dialogParams.hacs.localize("common.download"))}},{kind:"method",key:"_installRepository",value:(e=(0,c.A)((0,s.A)().mark((function t(){var r;return(0,s.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._repository){t.next=2;break}return t.abrupt("return");case 2:if(!this._waiting){t.next=5;break}return this._error="Waiting to update repository information, try later.",t.abrupt("return");case 5:if(!this._installing){t.next=8;break}return this._error="Already installing, please wait.",t.abrupt("return");case 8:if(this._repository.can_download){t.next=11;break}return this._error="Can not download this repository.",t.abrupt("return");case 11:return this._installing=!0,this._error=void 0,t.prev=13,t.next=16,(0,z.l)(this.hass,String(this._repository.id),"commit"!==(null===(r=this._repository)||void 0===r?void 0:r.version_or_commit)?this._repository.available_version:void 0);case 16:t.next=23;break;case 18:return t.prev=18,t.t0=t.catch(13),this._error=t.t0||{message:"Could not download repository, check core logs for more information."},this._installing=!1,t.abrupt("return");case 23:this._dialogParams.hacs.log.debug(this._repository.category,"_installRepository"),this._dialogParams.hacs.log.debug(this._dialogParams.hacs.info.lovelace_mode,"_installRepository"),this._installing=!1,"plugin"===this._repository.category&&(0,x.dk)(this,{title:this._dialogParams.hacs.localize("common.reload"),text:(0,m.qy)(F||(F=(0,a.A)(["","<br>",""])),this._dialogParams.hacs.localize("dialog.reload.description"),this._dialogParams.hacs.localize("dialog.reload.confirm")),dismissText:this._dialogParams.hacs.localize("common.cancel"),confirmText:this._dialogParams.hacs.localize("common.reload"),confirm:function(){A.G.location.href=A.G.location.href}}),void 0===this._error&&this.closeDialog();case 28:case"end":return t.stop()}}),t,this,[[13,18]])}))),function(){return e.apply(this,arguments)})},{kind:"get",static:!0,key:"styles",value:function(){return[R.k,(0,m.AH)(G||(G=(0,a.A)([".note{margin-top:12px}.lovelace{margin-top:8px}.learn_more{color:var(--hcv-text-color-primary)}pre{white-space:pre-line;user-select:all}mwc-linear-progress{margin-bottom:-8px;margin-top:4px}"])))]}}]}}),m.WF),o(),t.next=52;break;case 49:t.prev=49,t.t2=t.catch(0),o(t.t2);case 52:case"end":return t.stop()}}),t,null,[[0,49]])})));return function(r,e){return t.apply(this,arguments)}}())},51285:function(t,r,e){e.d(r,{l:function(){return a},v:function(){return o}});var n=e(94881),i=e(1781),o=function(){var t=(0,i.A)((0,n.A)().mark((function t(r,e){return(0,n.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r.connection.sendMessagePromise({type:"hacs/repository/info",repository_id:e}));case 1:case"end":return t.stop()}}),t)})));return function(r,e){return t.apply(this,arguments)}}(),a=function(){var t=(0,i.A)((0,n.A)().mark((function t(r,e,i){return(0,n.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r.connection.sendMessagePromise({type:"hacs/repository/download",repository:e,version:i}));case 1:case"end":return t.stop()}}),t)})));return function(r,e,n){return t.apply(this,arguments)}}()},83503:function(t,r,e){e.d(r,{J:function(){return n}});e(77052);var n=function(t){return"/hacsfiles/".concat(t.repository.full_name.split("/")[1],"/").concat(t.repository.file_name)}},79372:function(t,r,e){var n=e(73155),i=e(33817),o=e(3429),a=e(75077);t.exports=function(t,r){r&&"string"==typeof t||i(t);var e=a(t);return o(i(void 0!==e?n(e,t):t))}},18684:function(t,r,e){var n=e(87568),i=e(42509),o=e(30356),a=e(51607),s=e(95124),c=e(79635);n({target:"Array",proto:!0},{flatMap:function(t){var r,e=a(this),n=s(e);return o(t),(r=c(e,0)).length=i(r,e,e,n,0,1,t,arguments.length>1?arguments[1]:void 0),r}})},74991:function(t,r,e){e(33523)("flatMap")},69704:function(t,r,e){var n=e(87568),i=e(73155),o=e(30356),a=e(33817),s=e(3429),c=e(79372),l=e(23408),u=e(44933),h=e(89385),d=l((function(){for(var t,r,e=this.iterator,n=this.mapper;;){if(r=this.inner)try{if(!(t=a(i(r.next,r.iterator))).done)return t.value;this.inner=null}catch(o){u(e,"throw",o)}if(t=a(i(this.next,e)),this.done=!!t.done)return;try{this.inner=c(n(t.value,this.counter++),!1)}catch(o){u(e,"throw",o)}}}));n({target:"Iterator",proto:!0,real:!0,forced:h},{flatMap:function(t){return a(this),o(t),new d(s(this),{mapper:t,inner:null})}})},44856:function(t,r,e){e.d(r,{N:function(){return o}});e(27934),e(77052),e(71936),e(43859),e(68113),e(55888);var n=function(t){var r=[];function e(e,n){t=n?e:Object.assign(Object.assign({},t),e);for(var i=r,o=0;o<i.length;o++)i[o](t)}return{get state(){return t},action:function(r){function n(t){e(t,!1)}return function(){for(var e=[t],i=0;i<arguments.length;i++)e.push(arguments[i]);var o=r.apply(this,e);if(null!=o)return o instanceof Promise?o.then(n):n(o)}},setState:e,clearState:function(){t=void 0},subscribe:function(t){return r.push(t),function(){!function(t){for(var e=[],n=0;n<r.length;n++)r[n]===t?t=null:e.push(r[n]);r=e}(t)}}}},i=function(t,r,e,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{unsubGrace:!0};if(t[r])return t[r];var a,s,c=0,l=n(),u=function(){if(!e)throw new Error("Collection does not support refresh");return e(t).then((function(t){return l.setState(t,!0)}))},h=function(){return u().catch((function(r){if(t.connected)throw r}))},d=function(){s=void 0,a&&a.then((function(t){t()})),l.clearState(),t.removeEventListener("ready",u),t.removeEventListener("disconnected",f)},f=function(){s&&(clearTimeout(s),d())};return t[r]={get state(){return l.state},refresh:u,subscribe:function(r){1===++c&&function(){if(void 0!==s)return clearTimeout(s),void(s=void 0);i&&(a=i(t,l)),e&&(t.addEventListener("ready",h),h()),t.addEventListener("disconnected",f)}();var n=l.subscribe(r);return void 0!==l.state&&setTimeout((function(){return r(l.state)}),0),function(){n(),--c||(o.unsubGrace?s=setTimeout(d,5e3):d())}}},t[r]},o=function(t,r,e,n,o){return i(n,t,r,e).subscribe(o)}},3358:function(t,r,e){e.d(r,{OA:function(){return n.OA},WL:function(){return n.WL},u$:function(){return n.u$}});var n=e(41611)}}]);
//# sourceMappingURL=8518.p-fVKz1svy0.js.map