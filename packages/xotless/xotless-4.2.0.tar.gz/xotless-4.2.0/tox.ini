[tox]
envlist =
   {3.8,3.9,3.10,3.11,3.12}-unit
   3.12-{lint,staticcheck,doctest,coverage}

[testenv]
basepython =
    3.8: python3.8
    3.9: python3.9
    3.10: python3.10
    3.11: python3.11
    3.12: python3.12
    system: python

deps = pytest
       hypothesis~=6.98.6
       ipdb
       pytest-xdist~=2.1
       coverage[toml]>=7.4.0
       pytest-cov~=2.10
	   sentry-sdk~=1.5
       doctest: sphinx~=7.1.2
       staticcheck: mypy==1.10.0
       immutables: immutables

sitepackages = False

allowlist_externals = /usr/bin/make

commands=
   unit: pytest -l -q []
   immutables: pytest -l -q []
   staticcheck: mypy -p xotless --config-file {toxinidir}/mypy.ini
   doctest: make -C docs/ doctest
   coverage: pytest -l -q --cov=xotless []
